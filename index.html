

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Welcome to MicEMD’s documentation! &mdash; MicEMD  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> MicEMD
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to MicEMD’s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#Examples">Examples</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">MicEMD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Welcome to MicEMD’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-micemd-s-documentation">
<h1>Welcome to MicEMD’s documentation!<a class="headerlink" href="#welcome-to-micemd-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<textarea cols='20' rows='26'># MicEMD
Modeling, inversion and classification in electromagnetic underground metal target detection

Prerequisite: Installing Python and Conda

Currently, MicEMD will run on Python 3.5, 3.6, 3.7 and 3.8. And MicEMD depends on some packages in Conda, so the Anaconda or Miniconda should be installed in your system.

Installing Packages

`conda install SimPEG --channel conda-forge`

`conda install pyqt`


Run MicEMD

Clone the github repository:

`git clone https://github.com/UndergroundDetection/MICEMD.git`

To start the GUI from source, navigate through the src directory and run mainwindow.py:

`cd MICEMD/src`

`python mainwindow.py`
</textarea>
</div>

<h2>the GUI is as follows</h2>
<img src="./image/GUI.png" />
<p> <br />
<h2>A more exhaustive list of API methods：</h2>
<img src="./image/API.jpg" />
<div class="section" id="Examples">
<h1>Examples<a class="headerlink" href="#Examples" title="Permalink to this headline">¶</a></h1>
The simulation can be built by following steps:
1. Firstly, create the target, detector, collection class of the forward modeling, and call the simulate interface to generate the observed data.
2. Then, for the inversion problem, set the inversion parameters and call
the inverse interface to estimate the properties of the metal target;
for the classification problem, call the preprocess interface to reduce
the dimension of the observed data and call the classify interface to
classify underground metal targets.
3. Finally, create the Handler class to analyze, show, and save the results.

<h3>Example 1 FDEM Inversion</h3>
The example is to show FDEM simulation and the inversion application.
We simulated the EMI response of the metal cylinder targets in underground environments 
based on FDEM forward modeling and used the least-squares inversion methods to estimate 
the properties of the metal target conclude the triaxial coordinate(x,y,z), triaxial polarizability(βx,βy,βz), and the orientation(pitch and roll angle) of the metal target. 


<pre>
<textarea cols='20' rows='26'>
import numpy as np
import MicEMD.fdem as fdem
from MicEMD.handler import FDEMHandler


# Create and Initial the target, detector, collection class
target = fdem.Target(conductivity=5.71e7, permeability=1.26e-6, radius=0.2, pitch=0,
                     roll=0, length=1, position_x=0, position_y=0, position_z=-5)
detector = fdem.Detector(radius=0.4, current=20, frequency=1000, pitch=0, roll=0)
collection = fdem.Collection(spacing=0.5, height=0.1, SNR=30, x_min=-2, x_max=2,
                             y_min=-2, y_max=2, collection_direction='z-axis')
# call the interface of the fdem forward modeling
fwd_res = fdem.simulate(target, detector, collection, 'simpeg')


# set the inputs and parameters of the inversion
inv_inputs = (fwd_res, target, detector)
x0 = np.array([0.0, 0.0, -2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
inv_para = {'x0': x0, 'iterations': 10, 'tol': 1e-9}

# call the interface of the inversion
inv_res = fdem.inverse(inv_inputs, 'BFGS', inv_para)
# print(inv_res['error'], inv_res['pred'], inv_res['true'])


# create the FDEMHandler and call the methods to show and save the results
# set the FDEMHandler without parameters to save the results
# the file path of the results is generated by your settings

handler = FDEMHandler()
handler.save_fwd_data(fwd_res, 'magdata.csv')
# if you want get other axial mag_map, you can creat another collection with other
# collection_direction parameter, and input to the method show_mag_map
handler.show_mag_map(fwd_res, collection, show=True, save=True, file_name='mag_map.png')
handler.show_detection_scenario(target, collection, show=True, save=True)
handler.save_inv_res(inv_res, 'BFGS.csv')
handler.show_inv_res(inv_res, show=True, save=True, file_name='inv_res.png')

# set the FDEMHandler with parameters to save the results by default
# the file path of the results is generated according to the parameters of FDEMHandler
handler = FDEMHandler(target=target, collection=collection)
handler.save_fwd_data_default(fwd_res)
handler.show_detection_scenario_default(show=True)
handler.show_mag_map_default(fwd_res, show=True)
handler.save_inv_res_default(inv_res, 'BFGS')

</textarea></pre>
<h3>Example 2 TDEM Classification</h3>
<pre>
<textarea cols='20' rows='26'>
import numpy as np
import MicEMD.tdem as tdem
from MicEMD.preprocessor import data_prepare
from MicEMD.handler import TDEMHandler

# the attribute of the steel, Ni, and Al conclude permeability, permeability of vacuum and conductivity
attribute = np.array([[696.3028547, 875 * 1e-6, 50000000], [99.47183638, 125 * 1e-6, 14619883.04],
                      [1.000022202, 1.256665 * 1e-6, 37667620.91]])
# create and initial the target, detector, collection class of Tdem
target = tdem.Target(material=['Steel', 'Ni', 'Al'], shape=['Oblate spheroid', 'Prolate spheroid'],
                     attribute=attribute, ta_min=0.01, ta_max=1.5, tb_min=0.01, tb_max=1.5, a_r_step=0.08,
                     b_r_step=0.08)
detector = tdem.Detector(0.4, 20, 0, 0)
collection = tdem.Collection(t_split=20, snr=30)

# call the simulate interface, the forward_result is a tuple which conclude the Sample Set and a random
# sample of Sample Set, the random sample of Sample Set is used to visualize
fwd_res = tdem.simulate(target, detector, collection, model='dipole')

# split data sets and normalization for the Sample Set, Here we classify materials
ori_dataset_material = data_prepare(fwd_res[0], task='material')


# dimensionality reduction, return a tuple conclude train_set and test_set
dim_dataset_material = tdem.preprocess(ori_dataset_material, dim_red_method='SF')


# parameters setting of the classification model by dict
para = {'solver': 'lbfgs', 'hidden_layer_sizes': (50,), 'activation': 'tanh'}

# call the classify interface
# the res of the classification which is a dict that conclude accuracy, predicted value and true value
cls_material_res = tdem.classify(ori_dataset_material, 'ANN', para)


# create the TDEMHandler and call the methods to show and save the results
# set the TDEMHandler without parameters to save the results
# the file path of the results is generated by your settings
handler = TDEMHandler()

# save the forward results and one sample data
handler.save_fwd_data(fwd_res[0], file_name='fwd_res.csv')
handler.save_sample_data(fwd_res[1], file_name='sample.csv', show=True)

# save the original dataset that distinguishes material
handler.save_fwd_data(ori_dataset_material[0], file_name='ori_material_train.csv')
handler.save_fwd_data(ori_dataset_material[1], file_name='ori_material_test.csv')

# save the final dataset after dimensionality reduction
handler.save_fwd_data(dim_dataset_material[0], file_name='dim_material_train.csv')
handler.save_fwd_data(dim_dataset_material[1], file_name='dim_material_test.csv')

# save the classification results
handler.show_cls_res(cls_material_res, ['Steel', 'Ni', 'Al'], show=True, save=True, file_name='cls_result_material.pdf')
handler.save_cls_res(cls_material_res, 'cls_material_res.csv')

# classify the shape of the targets
ori_dataset_shape = data_prepare(fwd_res[0], task='shape')
dim_dataset_shape = tdem.preprocess(ori_dataset_shape, dim_red_method='SF')
cls_shape_res = tdem.classify(dim_dataset_shape, 'ANN', para)
# save the original dataset that distinguishes material
handler.save_fwd_data(ori_dataset_shape[0], file_name='ori_material_train.csv')
handler.save_fwd_data(ori_dataset_shape[1], file_name='ori_material_test.csv')
# save the final dataset after dimensionality reduction
handler.save_fwd_data(dim_dataset_shape[0], file_name='dim_material_train.csv')
handler.save_fwd_data(dim_dataset_shape[1], file_name='dim_material_test.csv')
handler.show_cls_res(cls_shape_res, ['Oblate spheroid', 'Prolate spheroid'], show=True, save=True, file_name='cls_result_shape.pdf')
handler.save_cls_res(cls_shape_res, 'cls_shape_res.csv')
</textarea>
</pre>
</div>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>

<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Shi Haodong, Liu Wen, Wang Zheng.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>